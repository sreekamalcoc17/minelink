<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.*?>

<StackPane xmlns:fx="http://javafx.com/fxml" fx:controller="com.minelink.controller.MainController"
           styleClass="root-pane">
           
    <!-- Main Content Container -->
    <VBox spacing="25" alignment="TOP_CENTER">
        <padding><Insets top="30" right="30" bottom="30" left="30"/></padding>
        
        <!-- HEADER -->
        <HBox alignment="CENTER_LEFT" spacing="15">
            <VBox>
                <Label text="MINELINK" styleClass="app-title"/>
                <Label text="QUANTUM TUNNEL" styleClass="subtitle" style="-fx-font-size: 10px; -fx-text-fill: #00f3ff;"/>
            </VBox>
            <Region HBox.hgrow="ALWAYS"/>
            <VBox alignment="CENTER_RIGHT">
                 <Label text="v2.0.0" styleClass="description-label"/>
                 <Label fx:id="statusLabel" text="SYSTEM ONLINE" styleClass="section-label" style="-fx-text-fill: #00ff88;"/>
            </VBox>
        </HBox>

        <!-- DASHBOARD GRID -->
        <HBox spacing="30" VBox.vgrow="ALWAYS">
            
            <!-- LEFT PANEL: CONFIGURATION -->
            <VBox spacing="25" prefWidth="380" styleClass="sidebar-panel">
                <padding><Insets top="25" right="25" bottom="25" left="25"/></padding>
                
                <!-- MODE SWITCH -->
                <VBox spacing="10">
                    <Label text="OPERATIONAL MODE" styleClass="section-label"/>
                    <fx:define>
                        <ToggleGroup fx:id="modeGroup"/>
                    </fx:define>
                    <HBox spacing="10" styleClass="mode-toggle-container">
                        <ToggleButton fx:id="hostRadio" text="HOST SERVER" toggleGroup="$modeGroup" 
                                      maxWidth="Infinity" HBox.hgrow="ALWAYS" styleClass="toggle-button"/>
                        <ToggleButton fx:id="clientRadio" text="JOIN NETWORK" toggleGroup="$modeGroup" selected="true"
                                      maxWidth="Infinity" HBox.hgrow="ALWAYS" styleClass="toggle-button"/>
                    </HBox>
                </VBox>
                
                <!-- PORT CONFIG -->
                <VBox spacing="8" fx:id="portBox">
                    <Label fx:id="portLabel" text="LAN PORT CONFIGURATION" styleClass="section-label"/>
                    <Label fx:id="portDescription" text="Enter Minecraft LAN port" styleClass="description-label"/>
                    <TextField fx:id="portField" promptText="25565" text="25565" styleClass="text-field"/>
                </VBox>

                <Separator style="-fx-opacity: 0.1;"/>

                <!-- CONNECTION CODE (IDENTITY) -->
                <VBox spacing="10">
                    <Label text="IDENTITY HASH" styleClass="section-label"/>
                    
                    <!-- Clickable Code Box -->
                    <StackPane styleClass="code-box" onMouseClicked="#onCopyCode">
                         <VBox spacing="0" alignment="CENTER">
                             <TextArea fx:id="connectionCodeArea" editable="false" wrapText="true" 
                                       prefRowCount="2" styleClass="code-text" 
                                       style="-fx-background-color: transparent; -fx-text-fill: #00f3ff; -fx-alignment: center; -fx-padding: 0;"/>
                             <Button fx:id="copyCodeButton" text="CLICK TO COPY" onAction="#onCopyCode"
                                     style="-fx-background-color: transparent; -fx-text-fill: #94a3b8; -fx-font-size: 10px; -fx-cursor: hand; -fx-padding: 0;"/>
                         </VBox>
                    </StackPane>
                </VBox>

                <Region VBox.vgrow="ALWAYS"/>
                
                <!-- MAIN ACTION -->
                <Button fx:id="startButton" text="INITIALIZE NETWORK" onAction="#onToggleNetwork"
                        styleClass="primary-button" maxWidth="Infinity" prefHeight="60"/>
                        
            </VBox>

            <!-- RIGHT PANEL: PEERS -->
            <VBox spacing="20" HBox.hgrow="ALWAYS" styleClass="glass-panel">
                <padding><Insets top="25" right="25" bottom="25" left="25"/></padding>
                
                <HBox alignment="CENTER_LEFT" spacing="15">
                    <Label text="ACTIVE CONNECTIONS" styleClass="header-label"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label fx:id="peersCountLabel" text="PEERS: 0" styleClass="section-label"/>
                </HBox>
                
                <!-- ADD PEER -->
                <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-background-color: rgba(255,255,255,0.05); -fx-background-radius: 8; -fx-padding: 5;">
                    <TextField fx:id="peerCodeField" promptText="Paste remote connection hash here..." 
                               HBox.hgrow="ALWAYS" style="-fx-background-color: transparent; -fx-border-width: 0;"/>
                    <Button text="ESTABLISH LINK" onAction="#onAddPeer" styleClass="secondary-button"/>
                </HBox>

                <!-- PEERS LIST -->
                <ScrollPane fx:id="peersScrollPane" fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="scroll-pane">
                    <VBox fx:id="peersContainer" spacing="15" styleClass="peers-container">
                        <!-- Dynamic Peer Cards -->
                    </VBox>
                </ScrollPane>
            </VBox>
        </HBox>
        
        <!-- FOOTER STATS -->
        <HBox spacing="30" styleClass="stats-strip" alignment="CENTER_LEFT">
             <HBox spacing="8" alignment="CENTER_LEFT">
                 <Label text="UPTIME" styleClass="section-label"/>
                 <Label fx:id="uptimeLabel" text="00:00:00" styleClass="stat-item"/>
             </HBox>
             <Region HBox.hgrow="ALWAYS"/>
             <HBox spacing="8" alignment="CENTER_LEFT">
                 <Label text="TX" styleClass="section-label"/>
                 <Label fx:id="sentLabel" text="0 KB" styleClass="stat-item"/>
             </HBox>
             <HBox spacing="8" alignment="CENTER_LEFT">
                 <Label text="RX" styleClass="section-label"/>
                 <Label fx:id="receivedLabel" text="0 KB" styleClass="stat-item"/>
             </HBox>
        </HBox>
    </VBox>
</StackPane>
