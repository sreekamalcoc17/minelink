<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.*?>

<StackPane xmlns:fx="http://javafx.com/fxml" fx:controller="com.minelink.controller.MainController"
           styleClass="root-pane">
           
    <!-- Main Content Container -->
    <VBox spacing="20" alignment="TOP_CENTER">
        <padding><Insets top="25" right="25" bottom="25" left="25"/></padding>
        
        <!-- HEADER -->
        <HBox alignment="CENTER_LEFT" spacing="15">
            <VBox>
                <Label text="MineLink" styleClass="app-title"/>
                <Label text="Quantum Tunnel" styleClass="subtitle"/>
            </VBox>
            <Region HBox.hgrow="ALWAYS"/>
            <VBox alignment="CENTER_RIGHT">
                 <Label text="v2.0.0" styleClass="description-label"/>
                 <Label fx:id="statusLabel" text="Ready" styleClass="section-label" style="-fx-text-fill: #71717a;"/>
            </VBox>
        </HBox>

        <!-- DASHBOARD GRID -->
        <HBox spacing="25" VBox.vgrow="ALWAYS">
            
            <!-- LEFT PANEL: CONFIGURATION -->
            <VBox spacing="24" prefWidth="360" styleClass="sidebar-panel">
                <padding><Insets top="24" right="24" bottom="24" left="24"/></padding>
                
                <!-- MODE SWITCH -->
                <VBox spacing="8">
                    <Label text="Network Mode" styleClass="section-label"/>
                    <fx:define>
                        <ToggleGroup fx:id="modeGroup"/>
                    </fx:define>
                    <HBox spacing="10" styleClass="mode-toggle-container">
                        <ToggleButton fx:id="hostRadio" text="Host Server" toggleGroup="$modeGroup" 
                                      maxWidth="Infinity" HBox.hgrow="ALWAYS" styleClass="toggle-button"/>
                        <ToggleButton fx:id="clientRadio" text="Join Network" toggleGroup="$modeGroup" selected="true"
                                      maxWidth="Infinity" HBox.hgrow="ALWAYS" styleClass="toggle-button"/>
                    </HBox>
                </VBox>
                
                <!-- PORT CONFIG -->
                <VBox spacing="8" fx:id="portBox">
                    <Label fx:id="portLabel" text="LAN Port" styleClass="section-label"/>
                    <TextField fx:id="portField" promptText="25565" text="25565" styleClass="text-field"/>
                    <Label fx:id="portDescription" text="Port from 'Open to LAN' screen" styleClass="description-label"/>
                </VBox>

                <Region VBox.vgrow="ALWAYS"/>

                <!-- CONNECTION CODE (IDENTITY) -->
                <VBox spacing="8">
                    <Label text="Your Identity" styleClass="section-label"/>
                    
                    <!-- Clickable Code Box -->
                    <StackPane styleClass="code-box" onMouseClicked="#onCopyCode">
                         <padding><Insets top="12" right="12" bottom="12" left="12"/></padding>
                         <VBox spacing="4" alignment="CENTER">
                             <TextArea fx:id="connectionCodeArea" editable="false" wrapText="true" 
                                       prefRowCount="2" styleClass="code-text" 
                                       style="-fx-background-color: transparent; -fx-padding: 0; -fx-alignment: center;"/>
                             <Button fx:id="copyCodeButton" text="Click to Copy" onAction="#onCopyCode"
                                     style="-fx-background-color: transparent; -fx-text-fill: #71717a; -fx-font-size: 11px; -fx-cursor: hand; -fx-padding: 0;"/>
                         </VBox>
                    </StackPane>
                </VBox>
                
                <!-- MAIN ACTION -->
                <Button fx:id="startButton" text="Start Network" onAction="#onToggleNetwork"
                        styleClass="primary-button" maxWidth="Infinity" prefHeight="50"/>
                        
            </VBox>

            <!-- RIGHT PANEL: PEERS -->
            <VBox spacing="20" HBox.hgrow="ALWAYS" styleClass="glass-panel">
                <padding><Insets top="24" right="24" bottom="24" left="24"/></padding>
                
                <HBox alignment="CENTER_LEFT" spacing="15">
                    <Label text="Active Connections" styleClass="header-label"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label fx:id="peersCountLabel" text="0 Online" styleClass="section-label"/>
                </HBox>
                
                <!-- ADD PEER -->
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <TextField fx:id="peerCodeField" promptText="Paste friend's connection code..." 
                               HBox.hgrow="ALWAYS" styleClass="text-field"/>
                    <Button text="Add Link" onAction="#onAddPeer" styleClass="secondary-button"/>
                </HBox>

                <!-- PEERS LIST -->
                <ScrollPane fx:id="peersScrollPane" fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="scroll-pane">
                    <VBox fx:id="peersContainer" spacing="12" styleClass="peers-container">
                        <!-- Dynamic Peer Cards -->
                    </VBox>
                </ScrollPane>
            </VBox>
        </HBox>
        
        <!-- FOOTER STATS -->
        <HBox spacing="30" styleClass="stats-strip" alignment="CENTER_LEFT">
             <HBox spacing="8" alignment="CENTER_LEFT">
                 <Label text="UPTIME" styleClass="section-label"/>
                 <Label fx:id="uptimeLabel" text="00:00:00" styleClass="stat-item"/>
             </HBox>
             <Region HBox.hgrow="ALWAYS"/>
             <HBox spacing="8" alignment="CENTER_LEFT">
                 <Label text="TX" styleClass="section-label"/>
                 <Label fx:id="sentLabel" text="0 KB" styleClass="stat-item"/>
             </HBox>
             <HBox spacing="8" alignment="CENTER_LEFT">
                 <Label text="RX" styleClass="section-label"/>
                 <Label fx:id="receivedLabel" text="0 KB" styleClass="stat-item"/>
             </HBox>
        </HBox>
    </VBox>
</StackPane>
